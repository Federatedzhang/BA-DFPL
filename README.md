This is the core code of BA-DFPL.
